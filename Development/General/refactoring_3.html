<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Zikula Core</title>
        <link rel="stylesheet" href="https://docs.ziku.la/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://docs.ziku.la/css/font-awesome.min.css">
        <link rel="stylesheet" href="https://docs.ziku.la/css/highlight.tomorrow-night.css">
        <link rel="stylesheet" href="https://docs.ziku.la/css/main.css">

        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
        <link rel="manifest" href="/site.webmanifest">
        <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
        <meta name="msapplication-TileColor" content="#da532c">
        <meta name="theme-color" content="#ffffff">
    </head>
    <body>
        <header class="navbar fixed-top navbar-dark bg-dark">
            <a class="navbar-brand" href="https://docs.ziku.la/" class="align-items-center">
                <img src="/favicon-32x32.png" alt="Zikula" />
                Zikula Core
                <small class="d-none d-lg-inline">
                    Zikula CMS and Symfony framework
                </small>
            </a>
                            <a href="https://github.com/zikula/core">
                    <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://docs.ziku.la/images/fork.png" alt="Fork me on GitHub" />
                </a>
                    </header>
        <main class="container-fluid">
            <div class="row">
                                    <nav id="sidebar" class="col-md-3 col-xl-2" role="navigation">
                                                    <p class="text-muted">
                                <a href="#section1" data-toggle="collapse">
                                    General
                                </a>
                            </p>
                            <ul id="section1" class="nav flex-column collapse show">
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/index.html" class="nav-link">
                                            About
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/General/Contributing/index.html" class="nav-link">
                                            Contributing
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/General/Releases/index.html" class="nav-link">
                                            Roadmap and Releases
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/General/vendorinformation.html" class="nav-link">
                                            Vendor information
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                <a href="#section2" data-toggle="collapse">
                                    Setup
                                </a>
                            </p>
                            <ul id="section2" class="nav flex-column collapse">
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Setup/requirements.html" class="nav-link">
                                            Requirements
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Setup/installation.html" class="nav-link">
                                            Installation
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Setup/upgrade.html" class="nav-link">
                                            Upgrade 2 to 3
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Setup/upgradefrom3to3.x.x.html" class="nav-link">
                                            Upgrade 3 to 3
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Setup/production.html" class="nav-link">
                                            Deployment
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                <a href="#section3" data-toggle="collapse">
                                    Configuration
                                </a>
                            </p>
                            <ul id="section3" class="nav flex-column collapse">
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Configuration/BundleConfig/index.html" class="nav-link">
                                            Bundle config
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Configuration/Settings/index.html" class="nav-link">
                                            Main settings
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Configuration/Localisation/index.html" class="nav-link">
                                            Localisation
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Configuration/Mailer/index.html" class="nav-link">
                                            Mailer
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Configuration/AdminPanel/index.html" class="nav-link">
                                            Admin panel
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Configuration/Security/index.html" class="nav-link">
                                            Security center
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Configuration/Extensions/index.html" class="nav-link">
                                            Extensions
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Configuration/Routes/index.html" class="nav-link">
                                            Routes
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Configuration/Workflows/index.html" class="nav-link">
                                            Workflows
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                <a href="#section4" data-toggle="collapse">
                                    Content
                                </a>
                            </p>
                            <ul id="section4" class="nav flex-column collapse">
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Content/pages.html" class="nav-link">
                                            Static pages
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Content/blocks.html" class="nav-link">
                                            Blocks
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                <a href="#section5" data-toggle="collapse">
                                    Access Control
                                </a>
                            </p>
                            <ul id="section5" class="nav flex-column collapse">
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/AccessControl/Groups/index.html" class="nav-link">
                                            Groups
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/AccessControl/Users/index.html" class="nav-link">
                                            Users
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/AccessControl/Authentication/index.html" class="nav-link">
                                            Authentication
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/AccessControl/Permissions/index.html" class="nav-link">
                                            Permissions
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                <a href="#section6" data-toggle="collapse">
                                    Layout &amp; Design
                                </a>
                            </p>
                            <ul id="section6" class="nav flex-column collapse">
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/LayoutDesign/Templating/index.html" class="nav-link">
                                            Templating
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/LayoutDesign/Themes/index.html" class="nav-link">
                                            Themes
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/LayoutDesign/Blocks/index.html" class="nav-link">
                                            Blocks
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/LayoutDesign/Menus/index.html" class="nav-link">
                                            Menus
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/LayoutDesign/Forms/index.html" class="nav-link">
                                            Forms
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                <a href="#section7" data-toggle="collapse">
                                    Translation
                                </a>
                            </p>
                            <ul id="section7" class="nav flex-column collapse">
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Translation/index.html" class="nav-link">
                                            Overview
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                <a href="#section8" data-toggle="collapse">
                                    Integration
                                </a>
                            </p>
                            <ul id="section8" class="nav flex-column collapse">
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Integration/Categories/index.html" class="nav-link">
                                            Categories
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Integration/Search/index.html" class="nav-link">
                                            Search
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                <a href="#section9" data-toggle="collapse">
                                    Extension Development
                                </a>
                            </p>
                            <ul id="section9" class="nav flex-column collapse">
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Development/General/index.html" class="nav-link active">
                                            General
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Development/Doctrine/index.html" class="nav-link">
                                            Databases & Doctrine
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Development/Extensions/index.html" class="nav-link">
                                            Extension services
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Development/Hooks/index.html" class="nav-link">
                                            Hooks
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Development/Misc/index.html" class="nav-link">
                                            Misc
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://modulestudio.de/en/documentation/10-introduction/" class="nav-link">
                                            Model-driven approach
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                <a href="#section10" data-toggle="collapse">
                                    Resources
                                </a>
                            </p>
                            <ul id="section10" class="nav flex-column collapse">
                                                                    <li class="nav-item">
                                        <a href="https://ziku.la" class="nav-link">
                                            Zikula website
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://github.com/zikula/core" class="nav-link">
                                            <i class="fab fa-github"></i> GitHub
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://joinslack.ziku.la/" class="nav-link">
                                            <i class="fab fa-slack"></i> Slack
                                        </a>
                                    </li>
                                                            </ul>
                                            </nav>
                                <section class="offset-md-3 offset-xl-2 col-md-9 col-xl-10">
                    <h1 id="refactoring-for-30">Refactoring for 3.0</h1>
<h2 id="modules">Modules</h2>
<h3 id="file-structure">File Structure</h3>
<p>The file structure of Zikula 3.0 is much different than the structure in 2.0. Instead of extensions being kept
in /modules or /themes, they are placed into /src/extensions. Much of the code that handles rendering pages
is outside the public folder that the webserver can see.</p>
<h3 id="composer-file">Composer file</h3>
<p>Add the following capability for defining the (default) admin icon:</p>
<pre><code class="language-json">    …
    "extra": {
        "zikula": {
            …
                "icon": "fas fa-star"
            },
        },
    },
</code></pre>
<p>You can remove the old <code>admin.png</code> file afterwards. In addition, it is recommended that you increment your module version
one full point (i.e. 3.0.0 -&gt; 4.0.0). Upgrading to core 3.0 is not backward compatible with core 2.0. Also, change the
php version to &gt;=7.2.5 (or higher if you module requires it) and the core-compatibility to &gt;=3.0.0.</p>
<pre><code class="language-{">  ...
  "version": "5.0.0",
  ...
  "require": {
    "php": "&gt;7.2.5",
    "zikula/core-bundle": "3.*"
  },
  "extra": {
    "zikula": {
      ...
      "core-compatibility": "&gt;=3.0.0",
      ...
      "icon": "fas fa-star",
      ...
    }
  }
}</code></pre>
<h3 id="interfaces">Interfaces</h3>
<p>In general, interfaces and apis implement argument type-hinting in all methods. This can break an implementation of
said interfaces, etc. Extensions must update their implementation of any core/system interface to adhere to the new
signature. For example, if you are upgrading a Block class, a member function line goes from:</p>
<p><code>public function display($properties) : {</code></p>
<p>to</p>
<p><code>public function display(array $properties) :string {</code></p>
<p>You can let php know to enforce strict type-hinting by putting <code>declare(strict_types=1);</code> at the top of each php
file just after the <code>&lt;?php</code> This is not required of other code, but strongly recommended.</p>
<h3 id="service-registration">Service registration</h3>
<p>Please use <code>autowire</code> and <code>autoconfigure</code> as this will magically solve most issues.
Further information can be found <a href="https://symfony.com/doc/current/service_container/3.3-di-changes.html#step-1-adding-defaults">in Symfony docs</a>.</p>
<p>Module services should be registered by their classname (automatically as above) and not with old-fashioned
<code>service.class.dot.notation</code>.</p>
<p>This change greatly simplifies using services, since each service does not have to be registered in your config files located in the Resources/config/ directory. Here is a previous services file from the Book module:</p>
<pre><code>services:
  paustian_book_module.container.link_container:
    class: Paustian\BookModule\Container\LinkContainer
    arguments:
      - "@translator.default"
      - "@router"
      - "@zikula_permissions_module.api.permission"
    tags:
      - { name: zikula.link_container }

  paustian_book_module.form.article_type:
    class: Paustian\BookModule\Form\Article
    arguments:
      - "@translator.default"
      - "@zikula_settings_module.locale_api"
    tags:
      - { name: form.type }
      ... 60 more lines...</code></pre>
<p>Instead this is simply taken care of by a much shorter file where autowire and autoconfigure are set to true:</p>
<pre><code>services:
  _defaults:
    autowire: true
    autoconfigure: true
    public: false
    bind:
      $extension: '@Paustian\Book\PaustianBookModule'

  Paustian\Book\:
    resource: '../../*'

  Paustian\Book\Helper:
    resource: '../../Helper/*'
    lazy: true</code></pre>
<p>Change <code>.yml</code> suffixes to <code>.yaml</code> (e.g. <code>routing.yaml</code>) and update <code>Extension.php</code> class. If you need to use a service
that is not injected automatically, you just add it to your method. For example:</p>
<pre><code>public function displayarticleAction(Request $request, 
                                BookArticlesEntity $article = null, 
                                bool $doglossary = true) : Response {
          [other code]
           $currentUserApi = $this-&gt;get('zikula_users_module.current_user');
           $uid = $currentUserApi-&gt;get('uid');</code></pre>
<p>is updated to:</p>
<pre><code>public function displayarticleAction(Request $request,
                                         BookArticlesEntity $article = null,
                                         bool $doglossary = true,
                                         CurrentUserApi $currentUserApi) : Response {
       [other code]
        $currentUserApi = $this-&gt;get('zikula_users_module.current_user');
        $uid = $currentUserApi-&gt;get('uid');</code></pre>
<p>Note how the CurrentUserApi was injected for you because of autowiring of the service.</p>
<h3 id="blocks">Blocks</h3>
<p>BlockHandler classes must implement <code>Zikula\BlocksModule\BlockHandlerInterface</code> as in Core-2.0 but there is no longer
a need to tag these classes in your services file as they are auto-tagged. Also - as above, the classname should be
used as the service name.</p>
<h3 id="extension-menus">Extension menus</h3>
<p><code>Zikula\Core\LinkContainer\LinkContainerCollector</code> and <code>Zikula\Core\LinkContainer\LinkContainerInterface</code> have been
removed. Extension menus are now implemented using Knp Menu instead. See directions in <a href="../../LayoutDesign/Menus/Dev/extensionmenu.html">ExtentionMenu</a> for further
information. Examination of the system menus is also helpful.</p>
<p>What this basically means is getting rid of LinkContainer and instead creating a Menu folder in your root directory.
Inside this directory is placed a ExtensionMenu.php file with an ExtensionMenu class. Follow the examples in the Zikula
core for implementation. Here is an example of the conversion of the BookModule from the old LinkContainer method to the
new ExtensionMenu method:</p>
<h3 id="linkcontainer-method">LinkContainer method</h3>
<pre><code>        $links = [];
        if ($this-&gt;permissionApi-&gt;hasPermission($this-&gt;getBundleName() . '::', '::', ACCESS_ADMIN)) {
            $submenulinks = [];
            $submenulinks[] = [
                'url' =&gt; $this-&gt;router-&gt;generate('paustianbookmodule_admin_edit'),
                'text' =&gt; $this-&gt;translator-&gt;__('Create New Book'),
                ];
            $submenulinks[] = [
                'url' =&gt; $this-&gt;router-&gt;generate('paustianbookmodule_admin_modify'),
                'text' =&gt; $this-&gt;translator-&gt;__('Edit or Delete Book'),
                 ];
            $links[] = [
                'url' =&gt; $this-&gt;router-&gt;generate('paustianbookmodule_admin_edit'),
                'text' =&gt; $this-&gt;translator-&gt;__('Books'),
                'icon' =&gt; 'book',
                'links' =&gt; $submenulinks];</code></pre>
<h3 id="exentionmenu-method">ExentionMenu method</h3>
<pre><code>        $menu = $this-&gt;factory-&gt;createItem('bookAdminMenu');
        //Book functions
        $menu-&gt;addChild('Book', [
            'uri' =&gt; '#',
        ])-&gt;setAttribute('icon', 'fas fa-book')
          -&gt;setAttribute('dropdown', true);
        $menu['Book']-&gt;addChild('Create New Book', [
            'route' =&gt; 'paustianbookmodule_admin_edit',
        ])-&gt;setAttribute('icon', 'fas fa-plus');
        $menu['Book']-&gt;addChild('Edit or Delete Book', [
            'route' =&gt; 'paustianbookmodule_admin_modify',
        ])-&gt;setAttribute('icon', 'fas fa-pencil');</code></pre>
<h2 id="sending-mails">Sending mails</h2>
<p>The <code>MailerApi</code> and <code>SwiftMailer</code> have been removed in favour of the Symfony Mailer component.</p>
<p>You will see the new interface is more intuitive. Start by injecting <code>Symfony\Component\Mailer\MailerInterface</code> and reading through the docs linked further below.</p>
<p>Here is a first example of how to migrate the code for sending mails:</p>
<pre><code class="language-php">// OLD

use Swift_Message;
use Zikula\MailerModule\Api\ApiInterface\MailerApiInterface;

class MyService
{
    // ...

    public function send()
    {
        // ...
        $message = new Swift_Message();
        $message-&gt;setFrom([$adminMail =&gt; $siteName]);
        $message-&gt;setTo([$user-&gt;getEmail() =&gt; $user-&gt;getUname()]);
        $this-&gt;mailer-&gt;sendMessage($message, $title, $htmlBody, '', true);
    }
}

// NEW

use Symfony\Component\Mailer\Exception\TransportExceptionInterface;
use Symfony\Component\Mailer\MailerInterface;
use Symfony\Component\Mime\Address;
use Symfony\Component\Mime\Email;

class MyService
{
    // ...

    public function send()
    {
        // ...
        try {
            $email = (new Email())
                -&gt;from(new Address($adminMail, $siteName))
                -&gt;to(new Address($user-&gt;getEmail(), $user-&gt;getUname()))
                -&gt;subject($title)
                -&gt;html($htmlBody)
            ;
            $this-&gt;mailer-&gt;send($email);
        } catch (TransportExceptionInterface $exception) {
            // ...
        }
}</code></pre>
<p>For more information please refer to <a href="../../Configuration/Mailer/index.html">Mailer docs</a>.</p>
<h2 id="translations">Translations</h2>
<p>All custom Zikula translation mechanisms have been removed in favour of Symfony's native translation system.</p>
<p>For more information please refer to <a href="../../Translation/index.html">Translation docs</a>.</p>
<h2 id="namespaces">Namespaces</h2>
<p>Several namespaces and classes have been relocated.</p>
<ul>
<li><code>Zikula\Bridge\HttpFoundation\</code> moved to <code>Zikula\Bundle\CoreBundle\HttpFoundation\Session\</code>.</li>
<li><code>Zikula\Bundle\CoreBundle\Bundle\AbstractCoreModule</code> moved into <code>Zikula\ExtensionsModule\</code>.</li>
<li><code>Zikula\Bundle\CoreBundle\Bundle\AbstractCoreTheme</code> moved into <code>Zikula\ExtensionsModule\</code>.</li>
<li><code>Zikula\Bundle\CoreBundle\Bundle\Bootstrap</code> moved and renamed to <code>Bundle\CoreBundle\Helper\PersistedBundleHelper</code>.</li>
<li><code>Zikula\Bundle\CoreBundle\Bundle\Helper\BootstrapHelper</code> moved and renamed to <code>Bundle\CoreBundle\Helper\BundlesSchemaHelper</code>.</li>
<li><code>Zikula\Bundle\CoreBundle\Bundle\MetaData</code> moved into <code>Zikula\Bundle\CoreBundle\Composer\</code>.</li>
<li><code>Zikula\Bundle\CoreBundle\Bundle\Scanner</code> moved into <code>Zikula\Bundle\CoreBundle\Composer\</code>.</li>
<li><code>Zikula\Common\Collection\</code> moved into <code>Zikula\Bundle\CoreBundle\Collection\</code>.</li>
<li><code>Zikula\Common\Content\</code> moved into <code>Zikula\ExtensionsModule\ModuleInterface\Content\</code>.</li>
<li><code>Zikula\Common\MultiHook\</code> moved into <code>Zikula\ExtensionsModule\ModuleInterface\MultiHook\</code>.</li>
<li><code>Zikula\Common\Translator\</code> moved into <code>Zikula\Bundle\CoreBundle\Translation\</code>.</li>
<li><code>Zikula\Common\ColumnExistsTrait</code> moved into <code>Zikula\Bundle\CoreBundle\Doctrine\</code>.</li>
<li><code>Zikula\Core\AbstractBundle</code> moved and renamed to <code>Zikula\ExtensionsModule\AbstractExtension</code></li>
<li><code>Zikula\Core\AbstractExtensionInstaller</code> moved into <code>Zikula\ExtensionsModule\Installer\</code>.</li>
<li><code>Zikula\Core\AbstractModule</code> moved into <code>Zikula\ExtensionsModule\</code>.</li>
<li><code>Zikula\Core\Controller\</code> moved into <code>Zikula\Bundle\CoreBundle\Controller\</code>.</li>
<li><code>Zikula\Core\CoreEvents</code> was split into <code>Zikula\Bundle\CoreBundle\CoreEvents</code> and <code>Zikula\ExtensionsModule\ExtensionEvents</code>.</li>
<li><code>Zikula\Core\Doctrine\</code> moved into <code>Zikula\Bundle\CoreBundle\Doctrine\</code>.</li>
<li><code>Zikula\Core\Event\GenericEvent</code> moved into <code>Zikula\Bundle\CoreBundle\Event\</code>.</li>
<li><code>Zikula\Core\Event\ModuleStateEvent</code> moved into <code>Zikula\ExtensionsModule\Event\</code>.</li>
<li><code>Zikula\Core\ExtensionInstallerInterface</code> moved into <code>Zikula\ExtensionsModule\Installer\</code>.</li>
<li><code>Zikula\Core\InstallerInterface</code> moved into <code>Zikula\ExtensionsModule\Installer\</code>.</li>
<li><code>Zikula\Core\Response\</code> moved into <code>Zikula\Bundle\CoreBundle\Response\</code>.</li>
<li><code>Zikula\Core\RouteUrl</code> moved into <code>Zikula\Bundle\CoreBundle\</code>.</li>
<li><code>Zikula\Core\UrlInterface</code> moved into <code>Zikula\Bundle\CoreBundle\</code>.</li>
<li><code>Zikula\ThemeModule\AbstractTheme</code> moved into <code>Zikula\ExtensionsModule\</code>.</li>
</ul>
<h2 id="events">Events</h2>
<p>Several events have been changed which requires updates in corresponding listeners.</p>
<ul>
<li>Core bundles
<ul>
<li><code>Zikula\Bundle\FormExtensionBundle\Event\FormTypeChoiceEvent</code> no longer extends <code>Symfony\Contracts\EventDispatcher\Event</code>.</li>
<li>Also, listeners should respond to the event <em>class</em>, the static property <code>NAME</code> is removed.</li>
<li><code>Zikula\Bundle\HookBundle\Hook\Hook</code> (and all its subclasses) no longer extends <code>Symfony\Contracts\EventDispatcher\Event</code>.</li>
</ul></li>
<li>Blocks module
<ul>
<li><code>get.pending_content</code> which was formerly in CoreBundle is removed in favor of <code>Zikula\BlocksModule\Event\PendingContentEvent</code></li>
<li><code>Zikula\Bundle\CoreBundle\Collection\Collectible\PendingContentCollectible</code> has changed its namespace to
<ul>
<li><code>Zikula\BlocksModule\Collectible\PendingContentCollectible</code></li>
</ul></li>
</ul></li>
<li>Extensions module
<ul>
<li><code>Zikula\ExtensionsModule\ExtensionEvents::REGENERATE_VETO</code> is removed in favor of <code>Zikula\ExtensionsModule\Event\ExtensionListPreReSyncEvent</code>.</li>
<li><code>Zikula\ExtensionsModule\ExtensionEvents::INSERT_VETO</code> is removed in favor of <code>Zikula\ExtensionsModule\Event\ExtensionEntityPreInsertEvent</code>.</li>
<li><code>Zikula\ExtensionsModule\ExtensionEvents::REMOVE_VETO</code> is removed in favor of <code>Zikula\ExtensionsModule\Event\ExtensionEntityPreRemoveEvent</code>.</li>
<li><code>Zikula\ExtensionsModule\ExtensionEvents::UPDATE_STATE</code> is removed in favor of <code>Zikula\ExtensionsModule\Event\ExtensionPreStateChangeEvent</code>.</li>
<li><code>Zikula\ExtensionsModule\ExtensionEvents::EXTENSION_INSTALL</code> is removed in favor of <code>Zikula\ExtensionsModule\Event\ExtensionPostInstallEvent</code>.</li>
<li><code>Zikula\ExtensionsModule\ExtensionEvents::EXTENSION_POSTINSTALL</code> is removed in favor of <code>Zikula\ExtensionsModule\Event\ExtensionPostCacheRebuildEvent</code>.</li>
<li><code>Zikula\ExtensionsModule\ExtensionEvents::EXTENSION_UPGRADE</code> is removed in favor of <code>Zikula\ExtensionsModule\Event\ExtensionPostUpgradeEvent</code>.</li>
<li><code>Zikula\ExtensionsModule\ExtensionEvents::EXTENSION_ENABLE</code> is removed in favor of <code>Zikula\ExtensionsModule\Event\ExtensionPostEnabledEvent</code>.</li>
<li><code>Zikula\ExtensionsModule\ExtensionEvents::EXTENSION_DISABLE</code> is removed in favor of <code>Zikula\ExtensionsModule\Event\ExtensionPostDisabledEvent</code>.</li>
<li><code>Zikula\ExtensionsModule\ExtensionEvents::EXTENSION_REMOVE</code> is removed in favor of <code>Zikula\ExtensionsModule\Event\ExtensionPostRemoveEvent</code>.</li>
<li><code>Zikula\ExtensionsModule\Event\ConnectionsMenuEvent</code> no longer extends <code>Symfony\Contracts\EventDispatcher\Event</code>.</li>
</ul></li>
<li>Groups module
<ul>
<li><code>Zikula\GroupsModule\GroupEvents::GROUP_CREATE</code> is removed in favor of <code>Zikula\GroupsModule\Event\GroupPostCreatedEvent</code></li>
<li><code>Zikula\GroupsModule\GroupEvents::GROUP_UPDATE</code> is removed in favor of <code>Zikula\GroupsModule\Event\GroupPostUpdatedEvent</code></li>
<li><code>Zikula\GroupsModule\GroupEvents::GROUP_PRE_DELETE</code> is removed in favor of <code>Zikula\GroupsModule\Event\GroupPreDeletedEvent</code></li>
<li><code>Zikula\GroupsModule\GroupEvents::GROUP_DELETE</code> is removed in favor of <code>Zikula\GroupsModule\Event\GroupPostDeletedEvent</code></li>
<li><code>Zikula\GroupsModule\GroupEvents::GROUP_ADD_USER</code> is removed in favor of <code>Zikula\GroupsModule\Event\GroupPostUserAddedEvent</code></li>
<li><code>Zikula\GroupsModule\GroupEvents::GROUP_REMOVE_USER</code> is removed in favor of <code>Zikula\GroupsModule\Event\GroupPostUserRemovedEvent</code></li>
<li><code>Zikula\GroupsModule\GroupEvents::GROUP_APPLICATION_PROCESSED</code> is removed in favor of <code>Zikula\GroupsModule\Event\GroupApplicationPostProcessedEvent</code></li>
<li><code>Zikula\GroupsModule\GroupEvents::GROUP_GROUP_NEW_APPLICATIONCREATE</code> is removed in favor of <code>Zikula\GroupsModule\Event\GroupApplicationPostCreatedEvent</code></li>
</ul></li>
<li>Menu module
<ul>
<li><code>Zikula\MenuModule\Event\ConfigureMenuEvent</code> no longer extends <code>Symfony\Contracts\EventDispatcher\Event</code>.</li>
<li>Also, listeners should respond to the event <em>class</em>, the static property <code>POST_CONFIGURE</code> is removed.</li>
</ul></li>
<li>Routes module
<ul>
<li><code>new.routes.avail</code> event is replaced by <code>Zikula\RoutesModule\Event\RoutesNewlyAvailableEvent</code></li>
</ul></li>
<li>SecurityCenter module
<ul>
<li><code>Zikula\SecurityCenterModule\Api\ApiInterface\HtmlFilterApiInterface::HTML_STRING_FILTER</code> is removed in favor of <code>Zikula\SecurityCenterModule\Event\FilterHtmlEvent</code></li>
</ul></li>
<li>Theme module
<ul>
<li><code>Zikula\ThemeModule::PRE_RENDER</code> is removed in favor of <code>Zikula\ThemeModule\Bridge\Event\TwigPreRenderEvent</code> (Same event, simply rename in Listener). </li>
<li><code>Zikula\ThemeModule::POST_RENDER</code> is removed in favor of <code>Zikula\ThemeModule\Bridge\Event\TwigPostRenderEvent</code> (Same event, simply rename in Listener).</li>
<li><code>Zikula\ThemeModule\Bridge\Event\TwigPostRenderEvent</code> no longer extends <code>Symfony\Contracts\EventDispatcher\Event</code>.</li>
<li><code>Zikula\ThemeModule\Bridge\Event\TwigPreRenderEvent</code> no longer extends <code>Symfony\Contracts\EventDispatcher\Event</code>.</li>
</ul></li>
<li>Users module
<ul>
<li><code>Zikula\UsersModule\RegistrationEvents::REGISTRATION_STARTED</code> has been deleted.</li>
<li><code>Zikula\UsersModule\RegistrationEvents::CREATE_REGISTRATION</code> is removed in favor of <code>Zikula\UsersModule\Event\RegistrationPostCreatedEvent</code>.</li>
<li><code>Zikula\UsersModule\RegistrationEvents::DELETE_REGISTRATION</code> is removed in favor of <code>Zikula\UsersModule\Event\RegistrationPostDeletedEvent</code>.</li>
<li><code>Zikula\UsersModule\RegistrationEvents::REGISTRATION_SUCCEEDED</code> is removed in favor of <code>Zikula\UsersModule\Event\RegistrationPostSuccessEvent</code>.</li>
<li><code>Zikula\UsersModule\RegistrationEvents::FORCE_REGISTRATION_APPROVAL</code> is removed in favor of <code>Zikula\UsersModule\Event\RegistrationPostApprovedEvent</code>.</li>
<li><code>Zikula\UsersModule\RegistrationEvents::UPDATE_REGISTRATION</code> is removed in favor of <code>Zikula\UsersModule\Event\RegistrationPostUpdatedEvent</code>.</li>
<li><code>Zikula\UsersModule\RegistrationEvents::FULL_USER_CREATE_VETO</code> is removed in favor of <code>Zikula\UsersModule\Event\ActiveUserPreCreatedEvent</code>.</li>
<li><code>Zikula\UsersModule\RegistrationEvents::REGISTRATION_FAILED</code> has been deleted.</li>
<li><code>Zikula\UsersModule\UserEvents::DISPLAY_VIEW</code> is removed in favor of <code>Zikula\UsersModule\Event\UserAccountDisplayEvent</code></li>
<li><code>Zikula\UsersModule\UserEvents::CREATE_ACCOUNT</code> is removed in favor of <code>Zikula\UsersModule\Event\ActiveUserPostCreatedEvent</code>.</li>
<li><code>Zikula\UsersModule\UserEvents::UPDATE_ACCOUNT</code> is removed in favor of <code>Zikula\UsersModule\Event\ActiveUserPostUpdatedEvent</code>.</li>
<li><code>Zikula\UsersModule\UserEvents::DELETE_ACCOUNT</code> is removed in favor of <code>Zikula\UsersModule\Event\ActiveUserPostDeletedEvent</code>.</li>
<li><code>Zikula\UsersModule\UserEvents::DELETE_VALIDATE</code> has been deleted.</li>
<li><code>Zikula\UsersModule\UserEvents::DELETE_FORM</code> is removed in favor of <code>Zikula\UsersModule\Event\DeleteUserFormPostCreatedEvent</code>.</li>
<li><code>Zikula\UsersModule\UserEvents::DELETE_PROCESS</code> is removed in favor of <code>Zikula\UsersModule\Event\DeleteUserFormPostValidatedEvent</code>.</li>
<li><code>Zikula\UsersModule\UserEvents::EDIT_FORM</code> is removed in favor of <code>Zikula\UsersModule\Event\EditUserFormPostCreatedEvent</code></li>
<li>The event class changed from <code>Zikula\UsersModule\Event\UserFormAwareEvent</code> to <code>EditUserFormPostCreatedEvent</code></li>
<li><code>Zikula\UsersModule\UserEvents::EDIT_FORM_HANDLE</code> is removed in favor of <code>Zikula\UsersModule\Event\EditUserFormPostValidatedEvent</code></li>
<li>The event class changed from <code>Zikula\UsersModule\Event\UserFormDataEvent</code> to <code>EditUserFormPostValidatedEvent</code></li>
<li><code>Zikula\UsersModule\UserEvents::FORM_SEARCH</code> has been deleted.</li>
<li><code>Zikula\UsersModule\UserEvents::FORM_SEARCH_PROCESS</code> has been deleted.</li>
<li><code>Zikula\UsersModule\UserEvents::CONFIG_UPDATED</code> has been deleted.</li>
<li><code>Zikula\UsersModule\AccessEvents::AUTHENTICATION_FORM</code> is removed in favor of <code>Zikula\UsersModule\Event\LoginFormPostCreatedEvent</code></li>
<li>The event class changed from <code>Zikula\UsersModule\Event\UserFormAwareEvent</code> to <code>LoginFormPostCreatedEvent</code></li>
<li><code>Zikula\UsersModule\AccessEvents::AUTHENTICATION_FORM_HANDLE</code> is removed in favor of <code>Zikula\UsersModule\Event\LoginFormPostValidatedEvent</code></li>
<li>The event class changed from <code>Zikula\UsersModule\Event\UserFormDataEvent</code> to <code>LoginFormPostValidatedEvent</code></li>
<li><code>Zikula\UsersModule\AccessEvents::LOGIN_STARTED</code> has been deleted.</li>
<li><code>Zikula\UsersModule\AccessEvents::LOGIN_VETO</code> is removed in favor of <code>Zikula\UsersModule\Event\UserPreLoginSuccessEvent</code></li>
<li><code>Zikula\UsersModule\AccessEvents::LOGIN_SUCCESS</code> is removed in favor of <code>Zikula\UsersModule\Event\UserPostLoginSuccessEvent</code></li>
<li><code>Zikula\UsersModule\AccessEvents::LOGIN_FAILED</code> is removed in favor of <code>Zikula\UsersModule\Event\UserPostLoginFailureEvent</code></li>
<li><code>Zikula\UsersModule\AccessEvents::LOGOUT_SUCCESS</code> is removed in favor of <code>Zikula\UsersModule\Event\UserPostLogoutSuccessEvent</code></li>
</ul></li>
</ul>
<h2 id="twig">Twig</h2>
<h3 id="classes">Classes</h3>
<p>Use namespaced classes because the non-namespaced classes have been removed.</p>
<p>For example:</p>
<table>
<thead>
<tr>
<th>Old</th>
<th>New</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>\Twig_Extension</code></td>
<td><code>Twig\Extension\AbstractExtension</code></td>
</tr>
<tr>
<td><code>\Twig_SimpleFunction</code></td>
<td><code>Twig\TwigFunction</code></td>
</tr>
<tr>
<td><code>\Twig_SimpleFilter</code></td>
<td><code>Twig\TwigFilter</code></td>
</tr>
<tr>
<td><code>\Twig_SimpleTest</code></td>
<td><code>Twig\TwigTest</code></td>
</tr>
</tbody>
</table>
<p>and so on…</p>
<h3 id="template-paths">Template paths</h3>
<ul>
<li>Change all template names from e.g. <code>Bundle:Controller:Action.html.twig</code> to <code>@Bundle/Controller/Action.html.twig</code>.</li>
<li>Modules and themes retain the <code>Module</code> or <code>Theme</code> suffix but bundles do not.</li>
<li>The form theme <code>@ZikulaFormExtension/Form/bootstrap_3_zikula_admin_layout.html.twig</code>
<ul>
<li>is changed to <code>@ZikulaFormExtension/Form/bootstrap_4_zikula_admin_layout.html.twig</code></li>
</ul></li>
</ul>
<h3 id="templates">Templates</h3>
<table>
<thead>
<tr>
<th>Topic</th>
<th>Old</th>
<th>New</th>
<th>Further information</th>
</tr>
</thead>
<tbody>
<tr>
<td>Filtering loops</td>
<td><code>{% for item in items if item.active %}</code></td>
<td><code>{% for item in items\|filter(i =&gt; i.active) %}</code></td>
<td><a href="https://symfony.com/blog/twig-adds-filter-map-and-reduce-features">blog post</a> with more examples</td>
</tr>
<tr>
<td>Filtering loops (alternative)</td>
<td><code>{% for item in items if item.active %}</code></td>
<td><code>{% for item in items %}{% if item.active %}</code></td>
<td></td>
</tr>
<tr>
<td>apply tag</td>
<td><code>{% filter upper %}…{% endfilter %}</code></td>
<td><code>{% apply upper %}…{% endapply %}</code></td>
<td><a href="https://symfony.com/blog/twig-adds-filter-map-and-reduce-features#the-apply-tag">blog post</a></td>
</tr>
<tr>
<td>spaceless filter</td>
<td><code>{% spaceless %}…{% endspaceless %}</code></td>
<td><code>{% apply spaceless %}…{% endapply %}</code></td>
<td><a href="https://symfony.com/blog/better-white-space-control-in-twig-templates#added-a-spaceless-filter">blog post</a></td>
</tr>
<tr>
<td>Old array extension</td>
<td><code>shuffle</code> filter</td>
<td>no equivalent</td>
</tr>
<tr>
<td>Old date extension</td>
<td><code>time_diff</code> filter</td>
<td>no equivalent</td>
</tr>
<tr>
<td>Old i18n extension</td>
<td><code>trans</code> filter</td>
<td>use the <code>trans</code> filter from Symfony</td>
<td><a href="https://symfony.com/doc/current/reference/twig_reference.html#trans">trans</a> reference</td>
</tr>
<tr>
<td>Old intl extension</td>
<td><code>localizeddate</code></td>
<td>use <code>format_date</code>, <code>format_datetime</code>, <code>format_time</code></td>
<td><a href="https://twig.symfony.com/doc/3.x/filters/format_date.html">format_date</a> reference, <a href="https://twig.symfony.com/format_datetime">format_datetime</a> reference, <a href="https://twig.symfony.com/format_time">format_time</a> reference</td>
</tr>
<tr>
<td>Old intl extension</td>
<td><code>{{ myNumber\|localizednumber }}</code></td>
<td><code>{{ myNumber\|format_number }}</code></td>
<td><a href="https://twig.symfony.com/doc/3.x/filters/format_number.html">format_number</a> reference</td>
</tr>
<tr>
<td>Old intl extension</td>
<td><code>{{ myAmount\|localizedcurrency('EUR') }}</code></td>
<td><code>{{ myAmount\|format_currency('EUR') }}</code></td>
<td><a href="https://twig.symfony.com/doc/3.x/filters/format_currency.html">format_currency</a> reference</td>
</tr>
<tr>
<td>Old text extension</td>
<td><code>{{ title\|truncate(200, true, '…') }}</code></td>
<td><code>{{ title\|u.truncate(200, '…') }}</code></td>
<td><a href="https://twig.symfony.com/doc/3.x/filters/u.html">u filter</a> reference</td>
</tr>
<tr>
<td>Old text extension</td>
<td><code>wordwrap</code></td>
<td><code>u</code></td>
<td><a href="https://twig.symfony.com/doc/3.x/filters/u.html">u filter</a> reference</td>
</tr>
<tr>
<td>Country name</td>
<td>unavailable</td>
<td><code>{{ myCountry\|country_name }}</code></td>
<td><a href="https://twig.symfony.com/country_name">country_name</a> reference</td>
</tr>
<tr>
<td>Currency name</td>
<td>unavailable</td>
<td><code>{{ myCurrency\|currency_name }}</code></td>
<td><a href="https://twig.symfony.com/currency_name">currency_name</a> reference</td>
</tr>
<tr>
<td>Currency symbol</td>
<td>unavailable</td>
<td><code>{{ 'EUR'\|currency_symbol }}</code></td>
<td><a href="https://twig.symfony.com/currency_symbol">currency_symbol</a> reference</td>
</tr>
<tr>
<td>Language name</td>
<td><code>{{ myLanguage\|languagename }}</code></td>
<td><code>{{ myLanguage\|language_name }}</code></td>
<td><a href="https://twig.symfony.com/language_name">language_name</a> reference</td>
</tr>
<tr>
<td>Locale name</td>
<td>unavailable</td>
<td><code>{{ myLocale\|locale_name }}</code></td>
<td><a href="https://twig.symfony.com/locale_name">locale_name</a> reference</td>
</tr>
<tr>
<td>Timezone name</td>
<td>unavailable</td>
<td><code>{{ myTimezone\|timezone_name }}</code></td>
<td><a href="https://twig.symfony.com/timezone_name">timezone_name</a> reference</td>
</tr>
</tbody>
</table>
<h3 id="admin-panel-integration">Admin panel integration</h3>
<ul>
<li>Remove all calls of <code>adminHeader()</code> and <code>adminFooter()</code> from extension templates.</li>
<li>Ensure that your admin theme calls them instead at a central place where appropriate.</li>
</ul>
                </section>
            </div>
        </main>
        <script src="https://docs.ziku.la/js/jquery.min.js"></script>
        <script src="https://docs.ziku.la/js/bootstrap.bundle.min.js"></script>
        <script src="https://docs.ziku.la/js/highlight.pack.js"></script>
        <script src="https://docs.ziku.la/js/site.js"></script>
    </body>
</html>
